{% extends 'anamnese/base.html' %}

{% block title %}Ficha de {{ ficha.nome }}{% endblock %}

{% block content %}
<div>
        <a href="{% url 'download_word' ficha.id %}" class="btn btn-primary">
            <i class="fas fa-file-word"></i> Baixar Word
        </a>
        <a href="{% url 'download_pdf' ficha.id %}" class="btn btn-success">
            <i class="fas fa-file-pdf"></i> Baixar PDF
        </a>
        <a href="{% url 'editar_ficha' ficha.id %}" class="btn btn-warning">
            <i class="fas fa-edit"></i> Editar
        </a>
        <a href="{% url 'lista_fichas' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar
        </a>
</div>

<!-- Dados Pessoais -->
<div class="card mb-4">
    <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="fas fa-user"></i> Dados Pessoais</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Nome:</strong> {{ ficha.nome }}</p>
                <p><strong>Data de Nascimento:</strong> {{ ficha.data_nascimento|date:"d/m/Y" }}</p>
                <p><strong>Idade:</strong> {{ ficha.idade }} anos</p>
                <p><strong>Sexo:</strong> {% if ficha.sexo == 'M' %}Masculino{% else %}Feminino{% endif %}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Telefone:</strong> {{ ficha.telefone }}</p>
                <p><strong>E-mail:</strong> {{ ficha.email }}</p>
                <p><strong>Profissão:</strong> {{ ficha.profissao }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Dados Antropométricos -->
<div class="card mb-4">
    <div class="card-header bg-success text-white">
        <h5 class="mb-0"><i class="fas fa-weight"></i> Dados Antropométricos</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-3">
                <p><strong>Peso Atual:</strong> {{ ficha.peso_atual }} kg</p>
            </div>
            <div class="col-md-3">
                <p><strong>Altura:</strong> {{ ficha.altura }} m</p>
            </div>
            <div class="col-md-3">
                <p><strong>Peso Desejado:</strong> {% if ficha.peso_desejado %}{{ ficha.peso_desejado }} kg{% else %}Não informado{% endif %}</p>
            </div>
            <div class="col-md-3">
                <p>
                    <strong>IMC:</strong> {{ ficha.calcular_imc }}
                    <span class="badge 
                        {% if ficha.calcular_imc < 18.5 %}bg-warning
                        {% elif ficha.calcular_imc < 25 %}bg-success
                        {% elif ficha.calcular_imc < 30 %}bg-warning
                        {% else %}bg-danger
                        {% endif %}">
                        {{ ficha.classificacao_imc }}
                    </span>
                </p>
            </div>
        </div>
        <div class="mt-3">
            <p><strong>Objetivo:</strong> <span class="badge bg-info">{{ ficha.get_objetivo_display }}</span></p>
        </div>
    </div>
</div>

<!-- História Clínica -->
<div class="card mb-4">
    <div class="card-header bg-warning text-dark">
        <h5 class="mb-0"><i class="fas fa-notes-medical"></i> História Clínica</h5>
    </div>
    <div class="card-body">
        <p><strong>Patologias/Doenças:</strong></p>
        <p>{{ ficha.patologias|default:"Nenhuma informada"|linebreaks }}</p>
        
        <p><strong>Medicamentos em Uso:</strong></p>
        <p>{{ ficha.medicamentos|default:"Nenhum informado"|linebreaks }}</p>
        
        <p><strong>Alergias/Intolerâncias:</strong></p>
        <p>{{ ficha.alergias_intolerancia|default:"Nenhuma informada"|linebreaks }}</p>
    </div>
</div>

<!-- Estilo de Vida -->
<div class="card mb-4">
    <div class="card-header bg-info text-white">
        <h5 class="mb-0"><i class="fas fa-running"></i> Estilo de Vida</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <p><strong>Nível de Atividade Física:</strong></p>
                <p>{{ ficha.get_nivel_atividade_display }}</p>
            </div>
            <div class="col-md-4">
                <p><strong>Refeições por Dia:</strong></p>
                <p>{{ ficha.refeicoes_dia }}</p>
            </div>
            <div class="col-md-4">
                <p><strong>Consumo de Água:</strong></p>
                <p>{{ ficha.consumo_agua }} L/dia</p>
            </div>
        </div>
        <p><strong>Restrições Alimentares:</strong></p>
        <p>{{ ficha.restricoes_alimentares|default:"Nenhuma informada"|linebreaks }}</p>
    </div>
</div>

<!-- Observações -->
{% if ficha.observacoes %}
<div class="card mb-4">
    <div class="card-header bg-secondary text-white">
        <h5 class="mb-0"><i class="fas fa-clipboard"></i> Observações</h5>
    </div>
    <div class="card-body">
        <p>{{ ficha.observacoes|linebreaks }}</p>
    </div>
</div>
{% endif %}

<!-- Informações da Ficha -->
<div class="card">
    <div class="card-body text-muted">
        <small>
            <i class="fas fa-clock"></i> Ficha criada em: {{ ficha.data_criacao|date:"d/m/Y às H:i" }}
        </small>
    </div>
</div>
{% endblock %}
